<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Blood Glucose & Lifestyle Simulation Tool</title>
  <!-- Chart.js CDN -->
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
  <style>
    /* CSS Variables for theme colors */
    :root {
      --primary-color: #007bff;
      --primary-hover: #0056b3;
      --bg-light: #f0f4f8;
      --bg-dark1: #1e2327;
      --bg-dark2: #2b3036;
      --container-light: rgba(255, 255, 255, 0.96);
      --container-dark: rgba(40, 44, 52, 0.95);
      --text-light: #333;
      --text-dark: #eee;
      --shadow: 0 12px 24px rgba(0, 0, 0, 0.15);
      --transition: 0.5s;
      --nav-gradient: linear-gradient(to right, #74ABE2, #5563DE);
    }

    /* Basic Reset */
    * {
      box-sizing: border-box;
      margin: 0;
      padding: 0;
    }

    body {
      font-family: "Segoe UI", Tahoma, Geneva, Verdana, sans-serif;
      background: linear-gradient(135deg, var(--bg-light), #d9e2ec);
      color: var(--text-light);
      padding: 20px;
      transition: background var(--transition), color var(--transition);
    }

    .dark-theme {
      background: linear-gradient(135deg, var(--bg-dark1), var(--bg-dark2));
      color: var(--text-dark);
    }

    .container {
      max-width: 1000px;
      margin: 0 auto;
      background: var(--container-light);
      border-radius: 12px;
      padding: 30px;
      box-shadow: var(--shadow);
      transition: background var(--transition), box-shadow var(--transition);
    }
    .dark-theme .container {
      background: var(--container-dark);
    }

    h1, h2, h3 {
      text-align: center;
      margin-bottom: 20px;
      line-height: 1.3;
    }

    /* Top Nav Bar */
    .top-nav {
      display: flex;
      justify-content: space-between;
      align-items: center;
      background: var(--nav-gradient);
      padding: 10px 20px;
      border-radius: 8px;
      margin-bottom: 20px;
      box-shadow: var(--shadow);
    }
    .top-nav button,
    .top-nav a {
      background-color: transparent;
      border: none;
      color: #fff;
      cursor: pointer;
      font-size: 1em;
      font-weight: 500;
      margin: 0 10px;
      padding: 8px 16px;
      border-radius: 6px;
      transition: background-color 0.3s, transform 0.2s;
      text-decoration: none;
    }
    .top-nav button:hover,
    .top-nav a:hover {
      background-color: rgba(255, 255, 255, 0.2);
      transform: scale(1.05);
    }
    .top-nav button:focus,
    .top-nav a:focus {
      outline: 2px solid #fff;
    }

    /* Chart Containers */
    .chart-wrapper {
      width: 100%;
      max-width: 800px;
      margin: 0 auto 40px auto;
      position: relative;
      height: 400px;
    }
    canvas {
      width: 100% !important;
      height: 100% !important;
    }

    /* Diet Bubble Chart */
    .diet-section {
      margin-top: 40px;
      text-align: center;
    }
    .region-filter {
      text-align: center;
      margin-bottom: 20px;
    }
    .region-filter label {
      font-weight: bold;
      margin-right: 10px;
    }
    .region-filter select {
      padding: 6px;
      border-radius: 4px;
      border: 1px solid #ccc;
      font-size: 1em;
    }
    .dark-theme .region-filter select {
      background: #444;
      color: #fff;
      border: 1px solid #666;
    }

    /* Modal for Bubble Chart and Explanation */
    .modal {
      display: none;
      position: fixed;
      z-index: 1000;
      left: 0;
      top: 0;
      width: 100%;
      height: 100%;
      overflow: auto; 
      background-color: rgba(0,0,0,0.4);
      animation: fadeInModal 0.4s;
    }
    @keyframes fadeInModal {
      from { background-color: rgba(0,0,0,0); }
      to { background-color: rgba(0,0,0,0.4); }
    }
    .modal-content {
      background: #fff;
      margin: 10% auto;
      padding: 20px;
      border-radius: 8px;
      max-width: 500px;
      position: relative;
      animation: slideDown 0.4s;
    }
    @keyframes slideDown {
      from { transform: translateY(-20px); opacity: 0; }
      to { transform: translateY(0); opacity: 1; }
    }
    .modal-close {
      position: absolute;
      top: 10px;
      right: 15px;
      color: #aaa;
      font-size: 22px;
      font-weight: bold;
      cursor: pointer;
    }
    .modal-close:hover {
      color: #000;
    }
    .dark-theme .modal-content {
      background: #333;
      color: #fff;
    }

    /* Simulation Tool */
    .glucose-tool {
      margin-top: 40px;
      text-align: center;
    }
    .glucose-tool h2 {
      margin-bottom: 15px;
    }
    .food-planner {
      display: flex;
      flex-wrap: wrap;
      justify-content: center;
      gap: 15px;
      margin-bottom: 20px;
    }
    .planner-section {
      display: flex;
      flex-direction: column;
      align-items: center;
    }
    .planner-section label {
      font-weight: bold;
      margin-bottom: 5px;
    }
    .planner-section select {
      padding: 8px;
      border-radius: 4px;
      border: 1px solid #ccc;
      min-width: 150px;
      max-height: 200px;
    }
    .dark-theme .planner-section select {
      background: #444;
      color: #fff;
      border: 1px solid #666;
    }
    .glucose-tool button {
      margin-top: 10px;
    }

    /* Additional Criteria */
    .additional-criteria {
      text-align: center;
      margin-bottom: 20px;
    }
    .additional-criteria label {
      font-weight: bold;
      margin: 0 10px;
    }
    .additional-criteria select {
      padding: 6px;
      border-radius: 4px;
      border: 1px solid #ccc;
      font-size: 1em;
      margin: 0 5px;
    }

    /* Write-Up */
    .writeup {
      margin-top: 40px;
      padding: 20px;
      background-color: #f9f9f9;
      border-left: 5px solid var(--primary-color);
    }
    @keyframes fadeInChart {
      0% {
        opacity: 0;
        transform: translateY(10px);
      }
      100% {
        opacity: 1;
        transform: translateY(0);
      }
    }

    /* Radar Interpreter */
    .radar-interpreter {
      margin-top: 20px;
      text-align: center;
      max-width: 800px;
      margin: 20px auto;
      padding: 20px;
      background: #fafafa;
      border-radius: 10px;
      border-left: 4px solid var(--primary-color);
      box-shadow: 0 2px 8px rgba(0,0,0,0.1);
    }
    .radar-interpreter form {
      display: flex;
      flex-wrap: wrap;
      justify-content: center;
      gap: 15px;
      margin-bottom: 15px;
    }
    .radar-interpreter label {
      font-weight: bold;
      display: block;
      margin-bottom: 5px;
    }
    .radar-interpreter input, .radar-interpreter select {
      padding: 6px;
      border: 1px solid #ccc;
      border-radius: 4px;
    }
    .dark-theme .radar-interpreter {
      background: #444;
      border-left-color: #0056b3;
    }

    /* Fade in interpretation */
    .interpreter-output {
      margin-top: 15px;
      animation: fadeInUp 0.8s ease;
    }
    @keyframes fadeInUp {
      from {
        opacity: 0;
        transform: translateY(20px);
      }
      to {
        opacity: 1;
        transform: translateY(0);
        opacity: 1;
      }
    }

    /* Responsive adjustments */
    @media (max-width: 600px) {
      .food-planner {
        flex-direction: column;
      }
      .chart-wrapper {
        height: 300px;
      }
    }
  </style>
</head>
<body>
  <!-- Top Nav -->
  <div class="top-nav">
    <button onclick="window.location.href='index.html';" aria-label="Back to Home">Back to Home</button>
    <a href="stats_crash_report.html" aria-label="Stats Crash Report">Stats Crash Report</a>
    <button id="themeToggle" aria-label="Toggle Dark/Light Theme">Toggle Theme</button>
  </div>

  <div class="container">
    <h1>Blood Glucose & Lifestyle Simulation Tool</h1>
    <p style="text-align:center;">
      Choose your foods, meal times, lifestyle factors, and filter by food quality then click “Plot Day” to see your simulated blood glucose response. 
      Below, you can also explore a “Holistic Lifestyle Radar” to gauge how balanced your habits are, plus an interpreter that factors in your condition.
    </p>

    <!-- ==========================
         Holistic Lifestyle Radar
         ========================== -->
    <div class="lifestyle-radar" style="margin-bottom: 40px;">
      <h2>Holistic Lifestyle Radar</h2>
      <p style="text-align:center; max-width:700px; margin: 0 auto 20px;">
        Rate each factor below on a scale of 1 (very poor) to 10 (excellent). Then click "Update Radar" to see how balanced your current lifestyle is. 
        Aim for a more rounded shape for overall wellness.
      </p>
      
      <!-- Factor Inputs -->
      <div style="display:flex; flex-wrap:wrap; justify-content:center; gap:20px; margin-bottom:20px;">
        <!-- Example factors; add or remove as needed -->
        <div style="text-align:center;">
          <label for="sleepInput"><strong>Sleep Quality</strong></label><br/>
          <input id="sleepInput" type="number" min="1" max="10" value="5" style="width:60px; text-align:center;" />
        </div>
        <div style="text-align:center;">
          <label for="stressInput"><strong>Stress Management</strong></label><br/>
          <input id="stressInput" type="number" min="1" max="10" value="5" style="width:60px; text-align:center;" />
        </div>
        <div style="text-align:center;">
          <label for="nutritionInput"><strong>Nutrition</strong></label><br/>
          <input id="nutritionInput" type="number" min="1" max="10" value="5" style="width:60px; text-align:center;" />
        </div>
        <div style="text-align:center;">
          <label for="activityInput"><strong>Physical Activity</strong></label><br/>
          <input id="activityInput" type="number" min="1" max="10" value="5" style="width:60px; text-align:center;" />
        </div>
        <div style="text-align:center;">
          <label for="emotionalInput"><strong>Emotional Well-being</strong></label><br/>
          <input id="emotionalInput" type="number" min="1" max="10" value="5" style="width:60px; text-align:center;" />
        </div>
        <div style="text-align:center;">
          <label for="hydrationInput"><strong>Hydration</strong></label><br/>
          <input id="hydrationInput" type="number" min="1" max="10" value="5" style="width:60px; text-align:center;" />
        </div>
      </div>
      
      <!-- Update Button -->
      <div style="text-align:center; margin-bottom:20px;">
        <button id="updateRadarBtn">Update Radar</button>
      </div>
      
      <!-- Radar Chart Container -->
      <div class="chart-wrapper" style="height: 400px;">
        <canvas id="wellnessRadar" aria-label="Holistic Lifestyle Radar" role="img"></canvas>
      </div>
    </div>

    <!-- Radar Interpreter Section -->
    <div class="radar-interpreter">
      <h3>Lifestyle Radar Interpreter</h3>
      <p style="max-width:600px; margin:0 auto 15px;">
        Please share a bit about your condition so we can tailor an interpretation of your lifestyle radar:
      </p>
      <form id="radarInterpreterForm">
        <div>
          <label for="userCondition">Your Condition:</label>
          <select id="userCondition">
            <option value="none" selected>No Specific Condition</option>
            <option value="diabetesType2">Type 2 Diabetes</option>
            <option value="preDiabetes">Pre-Diabetes</option>
            <option value="hypertension">Hypertension</option>
            <option value="other">Other / Not Listed</option>
          </select>
        </div>
        <div>
          <label for="userMedication">On Medication?</label>
          <select id="userMedication">
            <option value="no" selected>No</option>
            <option value="yes">Yes</option>
          </select>
        </div>
        <div>
          <label for="userAge">Your Age (Approx):</label>
          <input type="number" id="userAge" min="1" max="120" value="30" />
        </div>
        <div>
          <label for="userGoal">Primary Health Goal:</label>
          <input type="text" id="userGoal" placeholder="e.g., weight loss, better stamina" />
        </div>
      </form>
      <button id="interpretRadarBtn">Generate Interpretation</button>

      <!-- Output area -->
      <div id="radarInterpretation" style="display:none;" class="interpreter-output"></div>
    </div>
    
    <!-- Diet Bubble Chart -->
    <div class="diet-section" style="animation: fadeInChart 1s ease;">
      <h2>Recommended Diets & Foods</h2>
      <p>Explore foods from different regions. Click on a bubble for details.</p>
      <div class="region-filter">
        <label for="regionSelect">Filter by Region:</label>
        <select id="regionSelect">
          <option value="All">All</option>
          <option value="South Indian">South Indian</option>
          <option value="North Indian">North Indian</option>
          <option value="Italian">Italian</option>
          <option value="Thai">Thai</option>
          <option value="Fusion">Fusion</option>
        </select>
      </div>
      <div class="chart-wrapper" style="animation: fadeInChart 1s ease;">
        <canvas id="dietChart" aria-label="Diet bubble chart" role="img"></canvas>
      </div>
    </div>
    
    <!-- Blood Glucose Simulation Tool -->
    <div class="glucose-tool" style="animation: fadeInChart 1s ease;">
      <h2>Blood Glucose Simulation</h2>
      <p style="max-width:700px; margin:0 auto; line-height:1.5;">
        Select your foods for each meal. Use the filters below to narrow your choices and select your meal times. 
        Then choose lifestyle factors, meal size, and indicate if you’re diagnosed with hypoglycemia.
      </p>
      
      <!-- Food Category Filter and Meal Time Selectors -->
      <div class="additional-criteria">
        <label for="foodFilterSelect">Food Category Filter:</label>
        <select id="foodFilterSelect">
          <option value="All" selected>All</option>
          <option value="Good">Good</option>
          <option value="OK">OK</option>
          <option value="Bad">Bad</option>
        </select>
        <br/><br/>
        <label for="morningTimeSelect">Morning Time:</label>
        <select id="morningTimeSelect"></select>
        <label for="afternoonTimeSelect">Afternoon Time:</label>
        <select id="afternoonTimeSelect"></select>
        <label for="eveningTimeSelect">Evening Time:</label>
        <select id="eveningTimeSelect"></select>
      </div>
      
      <!-- Meal Size Selector -->
      <div class="additional-criteria">
        <label for="mealSizeSelect">Meal Size:</label>
        <select id="mealSizeSelect">
          <option value="small">Small</option>
          <option value="medium" selected>Medium</option>
          <option value="large">Large</option>
        </select>
      </div>
      
      <!-- Simulation Foods Multi-selects -->
      <div class="food-planner">
        <div class="planner-section">
          <label for="morningSelect">Morning Foods</label>
          <select id="morningSelect" multiple></select>
        </div>
        <div class="planner-section">
          <label for="afternoonSelect">Afternoon Foods</label>
          <select id="afternoonSelect" multiple></select>
        </div>
        <div class="planner-section">
          <label for="eveningSelect">Evening Foods</label>
          <select id="eveningSelect" multiple></select>
        </div>
      </div>
      
      <!-- Additional Lifestyle Criteria -->
      <div class="additional-criteria">
        <label for="sleepSelect">Sleep Quality/Duration:</label>
        <select id="sleepSelect">
          <option value="veryPoor">Very Poor (&lt;5 hrs)</option>
          <option value="poor">Poor (5–7 hrs)</option>
          <option value="normal" selected>Normal (7–9 hrs)</option>
          <option value="optimal">Optimal (&gt;9 hrs)</option>
        </select>
        <label for="stressSelect">Stress Level:</label>
        <select id="stressSelect">
          <option value="low">Low</option>
          <option value="moderate" selected>Moderate</option>
          <option value="high">High</option>
        </select>
        <label for="activitySelect">Activity Level:</label>
        <select id="activitySelect">
          <option value="sedentary">Sedentary</option>
          <option value="moderate" selected>Moderate</option>
          <option value="active">Active</option>
        </select>
        <label for="hypoDiagSelect">Diagnosed with Hypoglycemia?</label>
        <select id="hypoDiagSelect">
          <option value="no" selected>No</option>
          <option value="yes">Yes</option>
        </select>
      </div>
      
      <button id="plotDayBtn">Plot Day</button>
      <button id="clearGlucoseBtn">Clear</button>
      <button id="downloadChartBtn" aria-label="Download Glucose Chart">Download Chart</button>
      
      <div class="chart-wrapper" style="animation: fadeInChart 1s ease;">
        <canvas id="glucoseChart" aria-label="Blood Glucose Simulation Chart" role="img"></canvas>
      </div>
    </div>
    
    <!-- Reversal / Management Advice -->
    <div class="reversal-section" id="reversalSection" style="animation: fadeInChart 1s ease;">
      <h2>Reversal or Management Advice</h2>
      <p id="reversalContent"></p>
    </div>
    
    <!-- Write-Up on Blood Glucose Factors -->
    <div class="writeup">
      <h3>Understanding Blood Glucose Variations</h3>
      <p>
        <strong>Factors Affecting Blood Glucose:</strong> Blood sugar levels are influenced by the type and quality of carbohydrates consumed, sleep, stress, and physical activity.
      </p>
      <p>
        <strong>Spikes:</strong> Rapid increases force large insulin releases which over time may lead to insulin resistance.
      </p>
      <p>
        <strong>Drops:</strong> Excessively low levels can cause symptoms like shakiness and confusion.
      </p>
      <p>
        <strong>Oscillations:</strong> Wide fluctuations strain the body's regulatory systems and impair long-term metabolic control.
      </p>
      <p>
        <strong>Guidance:</strong> Maintaining a steady range (approximately 70–140 mg/dL) is ideal. If you experience frequent spikes, lows, or wide oscillations, review your diet and lifestyle and consult a healthcare professional.
      </p>
      <p>
        <strong>Reactive Hypoglycemia:</strong> In some individuals, an exaggerated insulin response after a meal leads to a dramatic drop in blood glucose levels. Our simulation reflects this with a dynamic, time‐dependent curve that shows a modest initial response, a pronounced dip when insulin peaks, and a gradual recovery as counter‑regulatory hormones act. Low glycemic index foods like avocado have been adjusted to show a more moderated drop, aligning with real‑world data and clinical research.
      </p>
    </div>
    
    <div class="info-section" style="animation: fadeInChart 1s ease;">
      <h3>References & Additional Information</h3>
      <ul>
        <li><a href="https://www.mayoclinic.org/">Mayo Clinic</a></li>
        <li><a href="https://www.niddk.nih.gov/">NIDDK</a></li>
        <li><a href="https://www.endocrine.org/">The Endocrine Society</a></li>
      </ul>
      <p>
        <strong>Disclaimer:</strong> This simulation is approximate and for demonstration purposes only.
      </p>
    </div>
  </div>
  
  <!-- Modal for Food Details -->
  <div id="foodDetailModal" class="modal" role="dialog" aria-modal="true" aria-labelledby="modalFoodTitle">
    <div class="modal-content">
      <span class="modal-close" id="foodModalClose" aria-label="Close Modal">&times;</span>
      <h3 id="modalFoodTitle"></h3>
      <p id="modalFoodCategory"></p>
      <p id="modalFoodReplacement"></p>
    </div>
  </div>
  
  <!-- Explanation Modal -->
  <div id="explanationModal" class="modal" role="dialog" aria-modal="true" aria-labelledby="explanationTitle">
    <div class="modal-content">
      <span class="modal-close" id="explanationModalClose" aria-label="Close Explanation">&times;</span>
      <h3 id="explanationTitle">Simulation Explanation</h3>
      <p id="explanationContent">
        This simulation displays your blood glucose dynamics over the course of the day. The baseline (green curve) is adjusted based on your sleep, stress, and activity levels. 
        For each meal, the food-specific curves show a postprandial spike in glucose followed by a decline. When hypoglycemia is enabled, the red curves simulate an exaggerated insulin response 
        leading to a sharper drop. However, for low glycemic index foods like avocado, the response is moderated to better reflect real-world physiology. Use this tool to understand how meal timing, 
        food quality, and lifestyle factors may influence your glucose regulation from morning to night.
      </p>
    </div>
  </div>
  
  <script>
    /********************************************************
     * THEME TOGGLE WITH PERSISTENCE
     ********************************************************/
    const themeToggle = document.getElementById('themeToggle');
    if(localStorage.getItem('theme') === 'dark') {
      document.body.classList.add('dark-theme');
    }
    themeToggle.addEventListener('click', () => {
      document.body.classList.toggle('dark-theme');
      localStorage.setItem('theme', document.body.classList.contains('dark-theme') ? 'dark' : 'light');
    });
    
    /********************************************************
     * 1) HOLISTIC LIFESTYLE RADAR
     ********************************************************/
    const wellnessCtx = document.getElementById('wellnessRadar').getContext('2d');
    
    // Default data (all factors = 5/10).
    let radarData = [5, 5, 5, 5, 5, 5];
    
    // Labels for each lifestyle factor in the same order as radarData.
    const factorLabels = [
      "Sleep Quality",
      "Stress Management",
      "Nutrition",
      "Physical Activity",
      "Emotional Well-being",
      "Hydration"
    ];
    
    // Create the radar chart
    let wellnessRadarChart = new Chart(wellnessCtx, {
      type: 'radar',
      data: {
        labels: factorLabels,
        datasets: [{
          label: "Current Lifestyle Balance",
          data: radarData,
          backgroundColor: "rgba(54, 162, 235, 0.2)",
          borderColor: "rgba(54, 162, 235, 1)",
          pointBackgroundColor: "rgba(54, 162, 235, 1)",
          pointRadius: 5,
          fill: true,
          tension: 0.2
        }]
      },
      options: {
        responsive: true,
        maintainAspectRatio: false,
        scales: {
          r: {
            suggestedMin: 0,
            suggestedMax: 10,
            ticks: { stepSize: 2 },
            angleLines: { color: "#ccc" },
            grid: { color: "#ccc" },
            pointLabels: {
              font: { size: 13 },
              color: "#666"
            }
          }
        },
        plugins: {
          legend: { display: false },
          tooltip: {
            callbacks: {
              label: function(context) {
                return context.label + ": " + context.parsed.r;
              }
            }
          }
        }
      }
    });
    
    // Update chart when user clicks "Update Radar"
    document.getElementById('updateRadarBtn').addEventListener('click', () => {
      // Get user inputs
      const sleepVal = parseInt(document.getElementById('sleepInput').value) || 5;
      const stressVal = parseInt(document.getElementById('stressInput').value) || 5;
      const nutritionVal = parseInt(document.getElementById('nutritionInput').value) || 5;
      const activityVal = parseInt(document.getElementById('activityInput').value) || 5;
      const emotionalVal = parseInt(document.getElementById('emotionalInput').value) || 5;
      const hydrationVal = parseInt(document.getElementById('hydrationInput').value) || 5;
    
      // Update data array
      radarData = [sleepVal, stressVal, nutritionVal, activityVal, emotionalVal, hydrationVal];
      wellnessRadarChart.data.datasets[0].data = radarData;
    
      // Animate & update the chart
      wellnessRadarChart.update();
    });

    /********************************************************
     * 1.1) RADAR INTERPRETER
     ********************************************************/
    const interpretRadarBtn = document.getElementById('interpretRadarBtn');
    const radarInterpretation = document.getElementById('radarInterpretation');

    interpretRadarBtn.addEventListener('click', () => {
      // Basic example of combining user condition with radar data
      const userCondition = document.getElementById('userCondition').value;
      const userMedication = document.getElementById('userMedication').value;
      const userAge = parseInt(document.getElementById('userAge').value) || 30;
      const userGoal = document.getElementById('userGoal').value.trim() || "general health";

      // Let’s interpret the radar data:
      const [sleep, stress, nutrition, activity, emotional, hydration] = radarData;

      // Start building an interpretation message
      let msg = `<strong>Condition:</strong> ${
        userCondition === "none" ? "No Specific Condition" : userCondition
      }<br/>
      <strong>Medication:</strong> ${userMedication === "yes" ? "Yes" : "No"}<br/>
      <strong>Age:</strong> ${userAge}<br/>
      <strong>Primary Goal:</strong> ${userGoal}<br/><br/>`;

      // Simple heuristics for demonstration
      msg += `Based on your radar scores:<ul>`;
      if (sleep < 5) {
        msg += `<li>Your <em>Sleep Quality</em> is on the lower side. 
                Improving rest might significantly benefit your overall health.</li>`;
      }
      if (stress < 5) {
        msg += `<li>Stress management is an area to focus on. Techniques like meditation or short walks may help.</li>`;
      }
      if (nutrition < 5) {
        msg += `<li>Your <em>Nutrition</em> score suggests a need to review dietary choices, 
                especially if you have a metabolic condition.</li>`;
      }
      if (activity < 5) {
        msg += `<li>Increasing <em>Physical Activity</em> could be key to reaching your goal of ${userGoal}.</li>`;
      }
      if (emotional < 5) {
        msg += `<li><em>Emotional Well-being</em> is a bit low. Consider hobbies, therapy, or community support.</li>`;
      }
      if (hydration < 5) {
        msg += `<li>Remember to stay hydrated! This is especially important if you’re on medication.</li>`;
      }
      msg += `</ul>`;

      // Condition-based suggestion
      if (userCondition === "diabetesType2") {
        msg += `<p><strong>Note:</strong> With Type 2 Diabetes, balancing your <em>Nutrition</em> and 
                <em>Physical Activity</em> can help control blood glucose. 
                Discuss your scores with a healthcare provider.</p>`;
      } else if (userCondition === "preDiabetes") {
        msg += `<p><strong>Note:</strong> Pre-diabetes can often be managed or reversed with lifestyle improvements. 
                Pay extra attention to <em>Nutrition</em> and <em>Activity</em>.</p>`;
      } else if (userCondition === "hypertension") {
        msg += `<p><strong>Note:</strong> For Hypertension, managing <em>Stress</em> and improving <em>Nutrition</em> 
                can help lower blood pressure over time.</p>`;
      }

      // Show the message
      radarInterpretation.innerHTML = msg;
      radarInterpretation.style.display = "block";
    });
    
    
    /********************************************************
     * 2) BUBBLE CHART FOR DIET
     ********************************************************/
    const goodFoodsAll = [
      { x: 1, y: 1, r: 10, label: "Plain Idly", replacement: "Healthy; add chutney", region: "South Indian" },
      { x: 2, y: 1, r: 10, label: "Rava Idly", replacement: "Pair with coconut chutney", region: "South Indian" },
      { x: 3, y: 1, r: 10, label: "Pongal (light ghee)", replacement: "Add veggies, reduce ghee", region: "South Indian" },
      { x: 4, y: 1, r: 10, label: "Avocado Toast", replacement: "Use whole wheat bread", region: "Italian" }
    ];
    const okFoodsAll = [
      { x: 2, y: 2, r: 8, label: "Filter Coffee", replacement: "Reduce sugar", region: "South Indian" },
      { x: 3, y: 3, r: 8, label: "Pongal (regular)", replacement: "Reduce ghee", region: "South Indian" }
    ];
    const badFoodsAll = [
      { x: 3, y: 4, r: 10, label: "Fried Idly", replacement: "Try steaming", region: "South Indian" },
      { x: 4, y: 4, r: 10, label: "White Bread Toast", replacement: "Switch to whole wheat", region: "Fusion" }
    ];
    let goodFoods = JSON.parse(JSON.stringify(goodFoodsAll));
    let okFoods = JSON.parse(JSON.stringify(okFoodsAll));
    let badFoods = JSON.parse(JSON.stringify(badFoodsAll));
    let dietChart;
    function renderBubbleChart() {
      const bubbleDatasets = [
        {
          label: "Good Foods",
          data: goodFoods,
          backgroundColor: "rgba(46, 204, 113, 0.6)",
          borderColor: "rgba(39, 174, 96, 1)"
        },
        {
          label: "OK Foods",
          data: okFoods,
          backgroundColor: "rgba(241, 196, 15, 0.6)",
          borderColor: "rgba(243, 156, 18, 1)"
        },
        {
          label: "Bad Foods",
          data: badFoods,
          backgroundColor: "rgba(231, 76, 60, 0.6)",
          borderColor: "rgba(192, 57, 43, 1)"
        }
      ];
      if (dietChart) {
        dietChart.destroy();
      }
      const dietCtx = document.getElementById('dietChart').getContext('2d');
      dietChart = new Chart(dietCtx, {
        type: 'bubble',
        data: { datasets: bubbleDatasets },
        options: {
          responsive: true,
          maintainAspectRatio: false,
          plugins: {
            legend: { display: true },
            tooltip: {
              callbacks: {
                label: context => context.raw.label
              }
            }
          },
          scales: {
            x: {
              title: {
                display: true,
                text: "Time of Day (1=Breakfast, 2=Mid-morning, 3=Lunch, 4=Afternoon, 5=Dinner, 6=Late night)"
              },
              min: 0,
              max: 7,
              ticks: { stepSize: 1 }
            },
            y: {
              title: { display: true, text: "Visual Spread" },
              min: 0,
              max: 5,
              ticks: { stepSize: 1 }
            }
          },
          animation: { duration: 1500, easing: 'easeOutBounce' },
          onClick: (evt, elements) => {
            if (elements.length > 0) {
              let element = elements[0];
              let datasetIndex = element.datasetIndex;
              let dataIndex = element.index;
              let clickedItem = dietChart.data.datasets[datasetIndex].data[dataIndex];
              openFoodModal(clickedItem, dietChart.data.datasets[datasetIndex].label);
            }
          }
        }
      });
    }
    const foodDetailModal = document.getElementById('foodDetailModal');
    const foodModalClose = document.getElementById('foodModalClose');
    const modalFoodTitle = document.getElementById('modalFoodTitle');
    const modalFoodCategory = document.getElementById('modalFoodCategory');
    const modalFoodReplacement = document.getElementById('modalFoodReplacement');
    function openFoodModal(item, category) {
      modalFoodTitle.textContent = item.label;
      modalFoodCategory.innerHTML = `<strong>Category:</strong> ${category} (Region: ${item.region})`;
      modalFoodReplacement.textContent = `Suggestion: ${item.replacement}`;
      foodDetailModal.style.display = 'block';
    }
    foodModalClose.addEventListener('click', () => {
      foodDetailModal.style.display = 'none';
    });
    window.addEventListener('click', (e) => {
      if (e.target == foodDetailModal) {
        foodDetailModal.style.display = 'none';
      }
    });
    const regionSelect = document.getElementById('regionSelect');
    regionSelect.addEventListener('change', applyRegionFilter);
    function applyRegionFilter() {
      const selected = regionSelect.value;
      goodFoods = goodFoodsAll.filter(item => (selected === "All") ? true : item.region === selected);
      okFoods = okFoodsAll.filter(item => (selected === "All") ? true : item.region === selected);
      badFoods = badFoodsAll.filter(item => (selected === "All") ? true : item.region === selected);
      renderBubbleChart();
    }
    renderBubbleChart();
    
    /********************************************************
     * 3) BLOOD GLUCOSE SIMULATION TOOL
     ********************************************************/
    const globalTimeAxis = [];
    const globalTimeLabels = [];
    for(let hr = 6; hr <= 22; hr++){
      globalTimeAxis.push(hr);
      let label = hr < 12 ? hr + " AM" : (hr === 12 ? "12 PM" : (hr-12) + " PM");
      globalTimeLabels.push(label);
    }
    let baselineData = new Array(globalTimeAxis.length).fill(90);
    
    const foodCurves = {
      "coffee": [90,100,95,90,85],
      "avocado": [85,88,87,85,83],
      "idly": [90,110,105,95,90],
      "dosa": [92,112,107,97,92],
      "medu vada": [95,115,110,100,95],
      "upma": [88,108,103,93,88],
      "pesarattu": [90,110,105,95,90],
      "rava idly": [92,112,107,97,92],
      "pongal": [95,120,110,100,95],
      "appam": [87,107,102,92,87],
      "poori": [100,130,125,115,110],
      "ragi dosa": [85,105,100,90,85],
      "neer dosa": [80,100,95,85,80],
      "adai": [90,110,105,95,90],
      "omelette": [80,90,85,80,75],
      "bagel": [95,125,120,110,105],
      "cereal": [85,120,115,105,100],
      "smoothie": [90,125,120,110,105],
      "granola": [88,118,113,103,98],
      "fruit salad": [75,90,85,80,75],
      "yogurt parfait": [80,95,90,85,80],
      "egg sandwich": [85,105,100,90,85],
      "french toast": [90,120,115,105,100],
      "waffles": [88,118,113,103,98],
      "pancakes": [90,120,115,105,100],
      "toast": [80,100,95,85,80],
      "muesli": [85,105,100,90,85],
      "scrambled eggs": [80,90,85,80,75],
      "protein shake": [75,95,90,85,80],
      "herbal tea": [70,80,75,70,65],
      "green tea": [70,80,75,70,65],
      "margherita pizza": [90,125,115,110,105],
      "pad thai": [88,118,113,103,98],
      "whole wheat pasta": [85,105,100,90,85],
      "burger": [88,120,115,105,100],
      "white bread": [85,130,120,110,100],
      "ice cream": [100,140,130,120,110],
      "hamburger": [90,120,110,105,100],
      "south indian veg meal (sambar, white rice)": [95,115,110,105,100],
      "south indian veg meal (sambar, yogurt, brown rice)": [90,110,105,100,95],
      "apple": [80,85,83,80,78],
      "banana": [85,95,90,85,80],
      "orange": [80,90,88,85,82],
      "mango": [90,105,100,95,90],
      "papaya": [90,105,100,95,90],
      "grapes": [80,95,90,85,80],
      "pear": [80,85,83,80,78],
      "kiwi": [85,95,90,85,80],
      "strawberry": [75,85,80,75,70],
      "blueberry": [80,90,85,80,75],
      "pineapple": [95,110,105,100,95],
      "chaat": [100,140,130,120,110],
      "bhel puri": [95,135,125,115,105],
      "pani puri": [90,130,120,110,100],
      "paav baaji": [100,140,135,125,115],
      "lemon juice": [70,75,72,70,68],
      "watermelon juice": [80,85,83,80,78],
      "sourdough bread": [80,105,100,95,90],
      "gluten free bread": [90,120,115,105,100],
      "protein milk shake (core)": [75,95,90,85,80]
    };
    
    // Improved hypoglycemia simulation with adjustable severity factor
    function getHypoCurve(curve, severityFactor = 1) {
      return curve.map((val, i) => {
        if (i === 0) {
          return val;
        } else if (i === 1) {
          return val - 10 * severityFactor;
        } else if (i === 2) {
          return val - 25 * severityFactor;
        } else if (i === 3) {
          return val - 15 * severityFactor;
        } else {
          return val - 10 * severityFactor;
        }
      });
    }
    
    // Plugin to highlight normal range on the chart
    const normalRangePlugin = {
      id: 'normalRange',
      beforeDraw: (chart, args, options) => {
        const {ctx, chartArea: {top, bottom, left, right}, scales: {y}} = chart;
        const normalMin = options.normalMin || 70;
        const normalMax = options.normalMax || 140;
        const yNormalMin = y.getPixelForValue(normalMin);
        const yNormalMax = y.getPixelForValue(normalMax);
        ctx.save();
        ctx.fillStyle = options.backgroundColor || 'rgba(0,255,0,0.1)';
        ctx.fillRect(left, yNormalMax, right - left, yNormalMin - yNormalMax);
        ctx.restore();
      }
    };
    
    let baselineDataset = {
      label: "Baseline (Green)",
      data: baselineData,
      borderColor: "rgba(46, 204, 113, 1)",
      backgroundColor: "rgba(46, 204, 113, 0.2)",
      fill: true,
      tension: 0.2
    };
    
    let glucoseChart = new Chart(document.getElementById('glucoseChart').getContext('2d'), {
      type: 'line',
      data: {
        labels: globalTimeLabels,
        datasets: [ baselineDataset ]
      },
      options: {
        responsive: true,
        maintainAspectRatio: false,
        plugins: {
          normalRange: {
            normalMin: 70,
            normalMax: 140,
            backgroundColor: "rgba(0,255,0,0.1)"
          },
          tooltip: {
            callbacks: {
              label: function(context) {
                let label = context.dataset.label || "";
                if(context.dataset.tooltipInfo) {
                  label += " - " + context.dataset.tooltipInfo;
                }
                label += ": " + context.parsed.y;
                return label;
              }
            }
          }
        },
        scales: {
          y: {
            beginAtZero: false,
            suggestedMin: 60,
            suggestedMax: 150,
            title: { display: true, text: "Blood Glucose (mg/dL)" }
          }
        }
      },
      plugins: [normalRangePlugin]
    });
    
    // Additional tooltip info for specific foods
    const foodTooltips = {
      "coffee": "Caffeine may induce transient insulin resistance. (Mayo Clinic)",
      "avocado": "Low GI with healthy fats and fiber. (NIDDK)",
      "idly": "Low glycemic index; gradual blood sugar rise.",
      "dosa": "Fermented batter improves digestibility; moderate spike.",
      "medu vada": "Higher in starch; potential for sharper spikes.",
      "upma": "Moderate GI; gradual glucose increase.",
      "pesarattu": "Similar to idly; steady release.",
      "rava idly": "Slight spike; similar to idly.",
      "pongal": "Balanced with protein; watch portion size.",
      "appam": "Generally low GI with mild spike.",
      "poori": "High GI; significant spike and rapid dip."
      // ... add more as needed
    };
    
    // Master list of foods for the simulation selects
    const simulationFoods = [
      { value: "coffee", label: "Coffee", category: "OK" },
      { value: "avocado", label: "Avocado", category: "Good" },
      { value: "idly", label: "Idly", category: "Good" },
      { value: "dosa", label: "Dosa", category: "Good" },
      { value: "medu vada", label: "Medu Vada", category: "Good" },
      { value: "upma", label: "Upma", category: "Good" },
      { value: "pesarattu", label: "Pesarattu", category: "Good" },
      { value: "rava idly", label: "Rava Idly", category: "Good" },
      { value: "pongal", label: "Pongal", category: "Good" },
      { value: "appam", label: "Appam", category: "Good" },
      { value: "poori", label: "Poori", category: "Bad" },
      { value: "ragi dosa", label: "Ragi Dosa", category: "Good" },
      { value: "neer dosa", label: "Neer Dosa", category: "Good" },
      { value: "adai", label: "Adai", category: "Good" },
      { value: "omelette", label: "Omelette", category: "Good" },
      { value: "bagel", label: "Bagel", category: "OK" },
      { value: "cereal", label: "Cereal", category: "OK" },
      { value: "smoothie", label: "Smoothie", category: "OK" },
      { value: "granola", label: "Granola", category: "OK" },
      { value: "fruit salad", label: "Fruit Salad", category: "Good" },
      { value: "yogurt parfait", label: "Yogurt Parfait", category: "Good" },
      { value: "egg sandwich", label: "Egg Sandwich", category: "OK" },
      { value: "french toast", label: "French Toast", category: "Bad" },
      { value: "waffles", label: "Waffles", category: "Bad" },
      { value: "pancakes", label: "Pancakes", category: "Bad" },
      { value: "toast", label: "Toast", category: "OK" },
      { value: "muesli", label: "Muesli", category: "OK" },
      { value: "scrambled eggs", label: "Scrambled Eggs", category: "Good" },
      { value: "protein shake", label: "Protein Shake", category: "OK" },
      { value: "herbal tea", label: "Herbal Tea (Unsweetened)", category: "Good" },
      { value: "green tea", label: "Green Tea (Unsweetened)", category: "Good" },
      { value: "margherita pizza", label: "Margherita Pizza", category: "Bad" },
      { value: "pad thai", label: "Pad Thai", category: "OK" },
      { value: "whole wheat pasta", label: "Whole Wheat Pasta", category: "Good" },
      { value: "burger", label: "Burger", category: "Bad" },
      { value: "white bread", label: "White Bread", category: "Bad" },
      { value: "ice cream", label: "Ice Cream", category: "Bad" },
      { value: "hamburger", label: "Hamburger", category: "Bad" },
      { value: "south indian veg meal (sambar, white rice)", label: "South Indian Veg Meal (Sambar, White Rice)", category: "Good" },
      { value: "south indian veg meal (sambar, yogurt, brown rice)", label: "South Indian Veg Meal (Sambar, Yogurt, Brown Rice)", category: "Good" },
      { value: "apple", label: "Fresh Apple", category: "Good" },
      { value: "banana", label: "Fresh Banana", category: "Good" },
      { value: "orange", label: "Fresh Orange", category: "Good" },
      { value: "mango", label: "Fresh Mango", category: "Good" },
      { value: "papaya", label: "Fresh Papaya", category: "Good" },
      { value: "grapes", label: "Fresh Grapes", category: "Good" },
      { value: "pear", label: "Fresh Pear", category: "Good" },
      { value: "kiwi", label: "Fresh Kiwi", category: "Good" },
      { value: "strawberry", label: "Fresh Strawberry", category: "Good" },
      { value: "blueberry", label: "Fresh Blueberry", category: "Good" },
      { value: "pineapple", label: "Fresh Pineapple", category: "Good" },
      { value: "chaat", label: "Chaat", category: "Bad" },
      { value: "bhel puri", label: "Bhel Puri", category: "Bad" },
      { value: "pani puri", label: "Pani Puri", category: "Bad" },
      { value: "paav baaji", label: "Paav Baaji", category: "Bad" },
      { value: "lemon juice", label: "Lemon Juice (Unsweetened)", category: "OK" },
      { value: "watermelon juice", label: "Watermelon Juice", category: "OK" },
      { value: "sourdough bread", label: "Sourdough Bread", category: "OK" },
      { value: "gluten free bread", label: "Gluten Free Bread", category: "OK" },
      { value: "protein milk shake (core)", label: "Protein Milk Shake (Core)", category: "OK" }
    ];
    
    const morningSelect = document.getElementById('morningSelect');
    const afternoonSelect = document.getElementById('afternoonSelect');
    const eveningSelect = document.getElementById('eveningSelect');
    const foodFilterSelect = document.getElementById('foodFilterSelect');
    
    function populateFoodSelects() {
      const filter = foodFilterSelect.value;
      [morningSelect, afternoonSelect, eveningSelect].forEach(select => select.innerHTML = "");
      const filteredFoods = simulationFoods.filter(item => filter === "All" || item.category === filter);
      filteredFoods.forEach(food => {
        const option = document.createElement("option");
        option.value = food.value;
        option.textContent = food.label;
        [morningSelect, afternoonSelect, eveningSelect].forEach(select => select.appendChild(option.cloneNode(true)));
      });
    }
    foodFilterSelect.addEventListener('change', populateFoodSelects);
    populateFoodSelects();
    
    const morningTimeSelect = document.getElementById('morningTimeSelect');
    const afternoonTimeSelect = document.getElementById('afternoonTimeSelect');
    const eveningTimeSelect = document.getElementById('eveningTimeSelect');
    function populateTimeSelect(select, startHour, endHour) {
      select.innerHTML = "";
      for(let hr = startHour; hr <= endHour; hr++){
        let option = document.createElement("option");
        option.value = hr;
        option.textContent = hr < 12 ? hr + " AM" : (hr === 12 ? "12 PM" : (hr-12) + " PM");
        select.appendChild(option);
      }
    }
    populateTimeSelect(morningTimeSelect, 6, 10);
    populateTimeSelect(afternoonTimeSelect, 12, 15);
    populateTimeSelect(eveningTimeSelect, 18, 21);
    
    function getColor(idx) {
      const colors = [
        "rgba(54, 162, 235, 1)",
        "rgba(255, 159, 64, 1)",
        "rgba(153, 102, 255, 1)",
        "rgba(75, 192, 192, 1)",
        "rgba(255, 205, 86, 1)"
      ];
      return colors[idx % colors.length];
    }
    
    const sleepSelect = document.getElementById('sleepSelect');
    const stressSelect = document.getElementById('stressSelect');
    const activitySelect = document.getElementById('activitySelect');
    const hypoDiagSelect = document.getElementById('hypoDiagSelect');
    const mealSizeSelect = document.getElementById('mealSizeSelect');
    const plotDayBtn = document.getElementById('plotDayBtn');
    const clearGlucoseBtn = document.getElementById('clearGlucoseBtn');
    const downloadChartBtn = document.getElementById('downloadChartBtn');
    
    // Explanation modal elements
    const explanationModal = document.getElementById('explanationModal');
    const explanationModalClose = document.getElementById('explanationModalClose');
    
    plotDayBtn.addEventListener('click', () => {
      let adjustedBaseline = [...baselineData];
    
      // Adjust baseline for sleep, stress, and activity
      const sleepAdj = { "veryPoor": 10, "poor": 5, "normal": 0, "optimal": -5 };
      const stressAdj = { "high": 10, "moderate": 5, "low": -5 };
      const activityAdj = { "sedentary": 5, "moderate": 0, "active": -10 };
    
      adjustedBaseline = adjustedBaseline.map(val => val + (sleepAdj[sleepSelect.value] || 0));
      adjustedBaseline = adjustedBaseline.map(val => val + (stressAdj[stressSelect.value] || 0));
      adjustedBaseline = adjustedBaseline.map(val => val + (activityAdj[activitySelect.value] || 0));
    
      // Reset the chart to just the baseline
      baselineDataset.data = adjustedBaseline;
      glucoseChart.data.datasets = [ baselineDataset ];
      
      // Get meal times
      const morningTime = parseInt(morningTimeSelect.value);
      const afternoonTime = parseInt(afternoonTimeSelect.value);
      const eveningTime = parseInt(eveningTimeSelect.value);
      const morningIndex = morningTime - 6;
      const afternoonIndex = afternoonTime - 6;
      const eveningIndex = eveningTime - 6;
      
      // Adjust meal size
      const mealSize = mealSizeSelect.value;
      let factor = mealSize === "small" ? 0.8 : (mealSize === "large" ? 1.2 : 1.0);
      
      // Function to add a food's curve to the chart
      function addFoodDataset(foodValue, startIndex, idx) {
        if(foodCurves[foodValue]) {
          const curve = foodCurves[foodValue].map(val => val * factor);
          let xVals = [], yVals = [];
          for(let i = 0; i < curve.length; i++){
            let pos = startIndex + i;
            if(pos < globalTimeAxis.length) {
              xVals.push(globalTimeLabels[pos]);
              yVals.push(curve[i]);
            }
          }
          let ds = {
            label: `Food: ${foodValue}`,
            data: xVals.map((x, i) => ({ x: x, y: yVals[i] })),
            borderColor: getColor(idx),
            backgroundColor: "rgba(0,0,0,0)",
            fill: false,
            tension: 0.2,
            borderWidth: 2,
            borderDash: [4,4],
            tooltipInfo: foodTooltips[foodValue] || "No additional data available"
          };
          glucoseChart.data.datasets.push(ds);
    
          // If user is diagnosed with hypoglycemia, add a "hypo variant"
          if(hypoDiagSelect.value === "yes") {
            let severityFactor = 1;
            // Example: reduce severity for a low-GI food like avocado
            if(foodValue === "avocado") {
              severityFactor = 0.5;
            }
            let hypoCurve = getHypoCurve(curve, severityFactor);
            let hypoX = [], hypoY = [];
            for(let i = 0; i < hypoCurve.length; i++){
              let pos = startIndex + i;
              if(pos < globalTimeAxis.length) {
                hypoX.push(globalTimeLabels[pos]);
                hypoY.push(hypoCurve[i]);
              }
            }
            let hypoDS = {
              label: `Hypo: ${foodValue}`,
              data: hypoX.map((x, i) => ({ x: x, y: hypoY[i] })),
              borderColor: "rgba(255,0,0,1)",
              backgroundColor: "rgba(255,0,0,0.2)",
              fill: false,
              tension: 0.2,
              borderWidth: 2,
              borderDash: [4,4],
              tooltipInfo: foodTooltips[foodValue]
                ? ("Hypo variant - " + foodTooltips[foodValue])
                : "No additional data available"
            };
            glucoseChart.data.datasets.push(hypoDS);
          }
        }
      }
      
      // Gather selected foods
      const morningFoods = Array.from(morningSelect.selectedOptions).map(o => o.value);
      const afternoonFoods = Array.from(afternoonSelect.selectedOptions).map(o => o.value);
      const eveningFoods = Array.from(eveningSelect.selectedOptions).map(o => o.value);
      
      // Add each selected food to the chart
      let idx = 0;
      morningFoods.forEach(food => { addFoodDataset(food, morningIndex, idx++); });
      afternoonFoods.forEach(food => { addFoodDataset(food, afternoonIndex, idx++); });
      eveningFoods.forEach(food => { addFoodDataset(food, eveningIndex, idx++); });
      
      // Animate the new data
      glucoseChart.options.animation = { duration: 2000, easing: 'easeInOutQuad' };
      glucoseChart.update();
      setTimeout(() => {
        glucoseChart.options.animation = {};
      }, 2200);
      
      // Show explanation modal with transition
      explanationModal.style.display = 'block';
    });
    
    // Clear chart button
    clearGlucoseBtn.addEventListener('click', () => {
      baselineDataset.data = baselineData;
      glucoseChart.data.datasets = [ baselineDataset ];
      glucoseChart.update();
    });
    
    // Download chart button
    downloadChartBtn.addEventListener('click', () => {
      const link = document.createElement('a');
      link.href = document.getElementById('glucoseChart').toDataURL('image/png');
      link.download = 'glucose_simulation_chart.png';
      link.click();
    });
    
    /********************************************************
     * 4) REVERSAL / MANAGEMENT ADVICE
     ********************************************************/
    const reversalContent = document.getElementById('reversalContent');
    reversalContent.innerHTML = `
      <strong>Hashimoto’s Thyroiditis:</strong> Usually managed with hormone therapy and regular monitoring.<br/><br/>
      <strong>Vitamin B12 Deficiency:</strong> Often reversible with supplementation and diet changes.<br/><br/>
      <strong>Iron Deficiency:</strong> May be reversed by addressing underlying causes and improving dietary intake.<br/><br/>
      <strong>Low Blood Pressure:</strong> Can be managed with fluids, salt, and addressing root causes.<br/><br/>
      <strong>Hypoglycemia:</strong> Requires balanced meals and careful monitoring to avoid dangerous lows.<br/><br/>
      <em>Always consult a healthcare professional for personalized guidance.</em>
    `;
    
    // Explanation modal close
    explanationModalClose.addEventListener('click', () => {
      explanationModal.style.display = 'none';
    });
    window.addEventListener('click', (e) => {
      if (e.target == explanationModal) {
        explanationModal.style.display = 'none';
      }
    });
  </script>
</body>
</html>
